!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.thoughtful=r():t.thoughtful=r()}(this,function(){return function(t){function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}var n={};return r.m=t,r.c=n,r.i=function(t){return t},r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:e})},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},r.p="",r(r.s=0)}([function(t,r,n){"use strict";function e(t){for(var n in t)r.hasOwnProperty(n)||(r[n]=t[n])}Object.defineProperty(r,"__esModule",{value:!0}),e(n(12)),e(n(2)),e(n(1)),e(n(3)),e(n(9)),e(n(4)),e(n(5)),e(n(8)),e(n(7)),e(n(6)),e(n(11)),e(n(10))},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=function(){function t(){}return t}();e.TANH={output:function(t){return Math.tanh(t)},der:function(t){var r=e.TANH.output(t);return 1-r*r}},e.SIGMOID={output:function(t){return 1/(1+Math.exp(-t))},der:function(t){var r=e.SIGMOID.output(t);return r*(1-r)}},e.RELU={output:function(t){return Math.max(0,t)},der:function(t){return t<=0?0:1}},e.LINEAR={output:function(t){return t},der:function(t){return 1}},r.Activations=e},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=function(){function t(t){this.options=t,this.neurons=[];for(var r=0;r<t.numberOfNeurons+1;r++)this.neurons.push(new o({index:r,isBiasUnit:r==t.numberOfNeurons,netOptions:t.netOptions,numberOfNeuronsInNextLayer:t.numberOfNeuronsInNextLayer}))}return t.prototype.forEachNeuron=function(t,r){void 0===r&&(r=!1);for(var n=0;n<this.neurons.length-(r?1:0);n++){var e=this.neurons[n];t(e,e.getIndex())}},t}(),o=function(){function t(t){this.options=t,this.weights=[],this.prevDelta=0,this.isBias()&&(this.output=1);for(var r=0;r<t.numberOfNeuronsInNextLayer;r++)this.weights.push(new i);this.activationFunction=this.options.netOptions.activationFunction}return t.prototype.propagateForward=function(t){var r=this;if(this.isBias())throw"A bias unit should not propagate a value forward.";var n=0;t.forEachNeuron(function(t){n+=t.output*t.getWeightTo(r).value}),this.input=n,this.output=this.activationFunction.output(this.input)},t.prototype.calculateOutputLayerDelta=function(t){if(this.isBias())throw"There should not be an output layer delta calculation for a bias unit for it is never used.";this.prevDelta=this.delta||0,this.delta=this.options.netOptions.errorFunction.der(this.output,t)*this.activationFunction.der(this.input)},t.prototype.calculateHiddenLayerDelta=function(t){var r=this;if(this.isBias())throw"There should not be an hidden layer delta calculation for a bias unit for it is not connected to the previous layer.";var n=0;t.forEachNeuron(function(t,e){n+=t.delta*r.weights[e].value},!0),this.prevDelta=this.delta||0,this.delta=this.activationFunction.der(this.input)*n},t.prototype.updateWeights=function(t){var r=this;t.forEachNeuron(function(t,n){var e=t.weights[r.getIndex()],o=t.output*r.delta,i=r.options.netOptions.momentum*r.prevDelta;e.value-=r.options.netOptions.learningRate*o+i})},t.prototype.getWeightTo=function(t){return this.weights[t.getIndex()]},t.prototype.isBias=function(){return this.options.isBiasUnit},t.prototype.getIndex=function(){return this.options.index},t}(),i=function(){function t(t){void 0===t&&(t=Math.random()),this.value=t}return t}(),u=function(){function t(t){this.options=t,this.layers=[];for(var r=0;r<t.layers.length;r++)this.layers.push(new e({netOptions:t,numberOfNeurons:t.layers[r],numberOfNeuronsInNextLayer:t.layers[r+1]||0}))}return t.restore=function(r,n){for(var e=new t(n),o=0;o<r.length;o++)for(var i=0;i<r[o].length;i++)for(var u=0;u<r[o][i].length;u++)e.layers[o].neurons[i].weights[u].value=r[o][i][u];return e},Object.defineProperty(t.prototype,"inputLayer",{get:function(){return this.layers[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputLayer",{get:function(){return this.layers[this.layers.length-1]},enumerable:!0,configurable:!0}),t.prototype.propagateForward=function(t){if(t.length!=this.inputLayer.neurons.length-1)throw"Inputs do not match network size!";this.inputLayer.forEachNeuron(function(r,n){return r.output=t[n]},!0);for(var r=this,n=1;n<this.layers.length;n++)!function(t){var n=r.layers[t],e=r.layers[t-1];n.forEachNeuron(function(t){return t.propagateForward(e)},!0)}(n);return this},t.prototype.getCurrentOutput=function(){return this.outputLayer.neurons.map(function(t){return t.output}).slice(0,-1)},t.prototype.calculateDeltas=function(t){this.outputLayer.forEachNeuron(function(r,n){return r.calculateOutputLayerDelta(t[n])},!0);for(var r=this,n=this.layers.length-2;n>0;n--)!function(t){var n=r.layers[t],e=r.layers[t+1];n.forEachNeuron(function(t){return t.calculateHiddenLayerDelta(e)},!0)}(n);return this},t.prototype.updateWeights=function(){for(var t=this,r=1;r<this.layers.length;r++)!function(r){var n=t.layers[r],e=t.layers[r-1];n.forEachNeuron(function(t){return t.updateWeights(e)},!0)}(r);return this},t.prototype.fit=function(t,r){return this.propagateForward(t).calculateDeltas(r).updateWeights(),this},t.prototype.predict=function(t){return this.propagateForward(t).getCurrentOutput()},t.prototype.getCurrentError=function(t){var r=this;return this.getCurrentOutput().reduce(function(n,e,o){return n+r.options.errorFunction.error(e,t[o])},0)},t.prototype.error=function(t,r){return this.propagateForward(t),this.getCurrentError(r)},t.prototype.exportWeights=function(){for(var t=[],r=0;r<this.layers.length-1;r++){var n=this.layers[r],e=n.neurons.map(function(t){return t.weights.map(function(t){return t.value})});t.push(e)}return t},t}();r.FeedForwardNeuralNetwork=u},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=function(){function t(){}return t}();e.SQUARE={error:function(t,r){return.5*Math.pow(t-r,2)},der:function(t,r){return t-r}},e.CROSS_ENTROPY={error:function(t,r){return-(r*Math.log(t)+(1-r)*Math.log(1-t))},der:function(t,r){return(t-r)/((1-t)*t)}},r.Errors=e},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=function(){function t(){this.dictionary=[]}return t.prototype.toValue=function(t){return this.dictionary.includes(t)?this.dictionary.indexOf(t):(this.dictionary.push(t),this.dictionary.length-1)},t.prototype.toClass=function(t){return this.dictionary[t]},t}();r.ClassToValue=e},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=function(){function t(){}return t}();e.EUCLIDEAN=function(t,r){return Math.sqrt(t.reduce(function(t,n,e){return t+Math.pow(n-r[e],2)},0))},e.TAXI=function(t,r){return t.reduce(function(t,n,e){return t+Math.abs(n-r[e])},0)},e.LEVENSHTEIN=function(t,r){return 0===t.length?r.length:0===r.length?t.length:Math.min(e.LEVENSHTEIN(t.substr(1),r)+1,e.LEVENSHTEIN(r.substr(1),t)+1,e.LEVENSHTEIN(t.substr(1),r.substr(1))+(t[0]!==r[0]?1:0))},r.Distances=e},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(0);!function(t){function r(t,r,n,o,i,u){void 0===r&&(r=10),void 0===n&&(n=2),void 0===o&&(o=0),void 0===i&&(i=1),void 0===u&&(u=.1);for(var a=new Array(t).fill(0).map(function(t){return new Array(n).fill(0).map(function(t){return e.Maths.random(o,i)})}),s=[],c=0,f=a;c<f.length;c++){for(var h=f[c],p=[],l=0;l<r;l++)p.push(h.map(function(t){return t+=(e.Maths.randomBool()?-1:1)*u*e.Maths.random(o,i)}));s.push({center:h,points:p})}return s}t.clouds=r}(r.Generators||(r.Generators={}))},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(0);!function(t){function r(t,r){return Math.floor(Math.random()*(r+1-t)+t)}function n(t,r){return Math.random()*(r-t)+t}function o(t){var r={};t.forEach(function(t){return r[t]=r[t]+1||1});for(var n=r[t[0]],e=t[0],o=0,i=t;o<i.length;o++){var u=i[o];r[u]>n&&(n=r[u],e=u)}return e}function i(){return Math.random()>.5}function u(t,r){void 0===r&&(r=1);var n=Math.pow(10,r);return Math.round(t*n)/n}function a(t){return(t instanceof e.Matrix?t.getColumnAsRowVector(0).getArray()[0]:t).reduce(function(t,r){return t+r},0)}t.randomInt=r,t.random=n,t.argmax=o,t.randomBool=i,t.round=u,t.sum=a}(r.Maths||(r.Maths={}))},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});!function(t){var r=function(){function t(t){this.data=t,this.minValues=[],this.maxValues=[];for(var r=t[0].length,n=this,e=0;e<r;e++)!function(r){var e=t.map(function(t){return t[r]});n.minValues.push(Math.min.apply(Math,e)),n.maxValues.push(Math.max.apply(Math,e))}(e)}return t.prototype.normalizeExampleData=function(){var t=this;return this.data.map(function(r,n){return r.map(function(r,n){return(r-t.minValues[n])/(t.maxValues[n]-t.minValues[n])})})},t.prototype.normalizeNewDataRow=function(t){var r=this;return t.map(function(t,n){return(n-r.minValues[n])/(r.maxValues[n]-r.minValues[n])})},t.prototype.denormalize=function(t){var r=this;return t.map(function(t,n){return n*(r.maxValues[n]-r.minValues[n])+r.minValues[n]})},t}();t.MinMaxNormalizer=r}(r.Normalization||(r.Normalization={}))},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(0);!function(t){function r(t,r){for(var n=0;n<r;n++)t(n)}function n(t,r,n,e){void 0===r&&(r=!0),void 0===n&&(n=","),void 0===e&&(e="\r\n");var o=t.trim().split(e).map(function(t){return t.split(n).map(function(t){return isNaN(t)?t:parseFloat(t)})});if(o[0].every(function(t){return"string"==typeof t})&&r){var i=o.splice(0,1)[0];return o.map(function(t,r){for(var n={},e=0;e<i.length;e++)n[i[e]]=t[e];return n})}return o}function o(t){return t[e.Maths.randomInt(0,t.length-1)]}t.repeat=r,t.csvStringToJSON=n,t.pickRandomFromArray=o}(r.Utilities||(r.Utilities={}))},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(0),o=function(){function t(t,r){var n=this;this.data=t,this.numberOfClusters=r,this.clusters=[],e.Utilities.repeat(function(){n.clusters.push(e.Utilities.pickRandomFromArray(t))},r)}return t.prototype.fitClusters=function(t){var r=this;void 0===t&&(t=e.Distances.EUCLIDEAN);var n,o=this;do{!function(){n=!1;for(var e=[],i=0,u=o.data;i<u.length;i++){var a=u[i];!function(r){var n=o.clusters.map(function(n){return t(r,n)}),i=Math.min.apply(Math,n),u=n.indexOf(i);e.push(u)}(a)}o.clusters.forEach(function(t,o){var i=e.map(function(t,n){return t==o?r.data[n]:null}).filter(function(t){return null!=t}),u=i.length,a=i.reduce(function(t,r){if(void 0!=r)return t.map(function(t,n){return t+r[n]})},new Array(r.data[0].length).fill(0)).map(function(t){return t/u});a.every(function(r,n){return r!=t[n]})&&(r.clusters[o]=a,n=!0)})}()}while(n);return this.clusters},t}();r.KMeans=o},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=n(0),o=function(){function t(t,r){return void 0===t&&(t=3),void 0===r&&(r=e.Distances.EUCLIDEAN),this.k=t,this.distanceFunction=r,this.data=[],this}return t.prototype.addData=function(t,r){var n=this;return t.forEach(function(t,e){n.data.push({c:t,attr:r[e]})}),this},t.prototype.predict=function(t,r){var n=this,o=[];this.data.forEach(function(r,e){return o.push({index:e,distance:n.distanceFunction(t,r.attr)})}),o=o.sort(function(t,r){return t.distance>r.distance?1:t.distance<r.distance?-1:0});var i=o.slice(0,this.k),u=i.map(function(t){return n.data[t.index].c}),a=e.Maths.argmax(u);return r?r.toClass(a):a},t}();r.KNNClassifier=o},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var e=function(){function t(r,n){this.data="object"==typeof r?r:t.get2DArray(r,n)}return t.get2DArray=function(t,r,n){return void 0===n&&(n=0),new Array(t).fill(0).map(function(t){return new Array(r).fill(n)})},t.rowVector=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return new t([r])},t.columnVector=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return new t(r.map(function(t){return[t]}))},t.rand=function(r,n){var e=new t(r,n);return e.map(function(t){return Math.random()}),e},t.ones=function(r,n){var e=new t(r,n);return e.fill(1),e},t.eye=function(r){for(var n=new t(r,r),e=0;e<r;e++)n.set(e,e,1);return n},t.join=function(r,n,e){void 0===e&&(e="bottom");var o;switch(e){case"top":o=n.data.concat(r.data);break;case"bottom":o=r.data.concat(n.data);break;case"left":o=r.data.map(function(t,r){return n.data[r].concat(t)});break;case"right":o=r.data.map(function(t,r){return t.concat(n.data[r])})}return new t(o)},t.prototype.size=function(){return[this.getNumberOfRows(),this.getNumberOfColumns()]},t.prototype.getNumberOfRows=function(){return this.data.length},t.prototype.getNumberOfColumns=function(){return this.data[0].length},t.prototype.getDimensions=function(){return[this.getNumberOfRows(),this.getNumberOfColumns()]},t.prototype.set=function(t,r,n){this.data[t][r]=n},t.prototype.get=function(t,r){return this.data[t][r]},t.prototype.getRowAsRowVector=function(r){return new t([this.data[r].slice()])},t.prototype.getColumnAsRowVector=function(r){for(var n=[],e=0,o=this.data;e<o.length;e++){var i=o[e];n.push(i[r])}return new t([n])},t.prototype.getAsScalar=function(){if(this.getDimensions().every(function(t){return 1==t}))return this.get(0,0);this.error("size","getAsFloat (matrix must be 1x1)")},t.prototype.getArray=function(){return this.data.map(function(t){return t.slice()})},t.prototype.copy=function(){return new t(this.getArray())},t.prototype.slice=function(r,n,e,o){n<0&&(n=this.getNumberOfRows()+(n+1)),r<0&&(r=this.getNumberOfRows()+(r+1)),o<0&&(o=this.getNumberOfColumns()+(o+1)),e<0&&(e=this.getNumberOfColumns()+(e+1));for(var i=new t(n-r,o-e),u=r;u<n;u++)for(var a=e;a<o;a++)i.set(u-r,a-e,this.get(u,a));return i},t.prototype.map=function(t){for(var r=0;r<this.getNumberOfRows();r++)for(var n=0;n<this.getNumberOfColumns();n++)this.data[r][n]=t(this.data[r][n],r,n);return this},t.prototype.forEach=function(t){for(var r=0;r<this.getNumberOfRows();r++)for(var n=0;n<this.getNumberOfColumns();n++)t(this.data[r][n],r,n);return this},t.prototype.fill=function(t){return this.map(function(r){return t})},t.prototype.scale=function(t){return this.map(function(r){return r*t})},t.prototype.add=function(t){return this.hasSameDimensions(t)||this.error("size","addition"),this.map(function(r,n,e){return r+t.get(n,e)})},t.prototype.subtract=function(t){return this.hasSameDimensions(t)||this.error("size","subtraction"),this.map(function(r,n,e){return r-t.get(n,e)})},t.prototype.multiply=function(t){return this.hasSameDimensions(t)||this.error("size","multiplication"),this.map(function(r,n,e){return r*t.get(n,e)})},t.prototype.divide=function(t){return this.hasSameDimensions(t)||this.error("size","division"),this.map(function(r,n,e){return r/t.get(n,e)})},t.prototype.dot=function(r){this.getNumberOfColumns()!=r.getNumberOfRows()&&this.error("size","dot product");for(var n=t.get2DArray(this.getNumberOfRows(),r.getNumberOfColumns()),e=0;e<r.getNumberOfColumns();e++)for(var o=0;o<this.getNumberOfRows();o++)for(var i=0;i<r.getNumberOfRows();i++)n[o][e]+=r.get(i,e)*this.get(o,i);return this.data=n,this},t.prototype.transpose=function(){var r=t.get2DArray(this.getNumberOfColumns(),this.getNumberOfRows());return this.forEach(function(t,n,e){r[e][n]=t}),this.data=r,this},t.prototype.min=function(){for(var r=[],n=0;n<this.getNumberOfColumns();n++){var e=this.getColumnAsRowVector(n).getArray()[0];r.push(Math.min.apply(Math,e))}return t.rowVector.apply(t,r)},t.prototype.max=function(){for(var r=[],n=0;n<this.getNumberOfColumns();n++){var e=this.getColumnAsRowVector(n).getArray()[0];r.push(Math.max.apply(Math,e))}return t.rowVector.apply(t,r)},t.prototype.hasSameDimensions=function(t){return t.getNumberOfColumns()==this.getNumberOfColumns()&&t.getNumberOfRows()==this.getNumberOfRows()},t.prototype.error=function(t,r){switch(t){case"size":throw"Matrices not not have the right sizes for operation "+r;default:throw"Error!"}},t.prototype.show=function(){return console.log(this.getAsString()),this},t.prototype.getAsString=function(t,r,n,e,o){var i=this;return void 0===t&&(t=!0),void 0===r&&(r="\t"),void 0===n&&(n=" "),void 0===e&&(e="\n"),void 0===o&&(o=3),t?this.data.map(function(t,e){var u=t.map(function(t){return t.toFixed(o)}).join(r);return 0==e&&1==i.data.length?"["+n+u+n+"]":0==e?"⎡"+n+u+n+"⎤":e==i.data.length-1?"⎣"+n+u+n+"⎦":"⎜"+n+u+n+"⎟"}).join("\n")+e:this.data.map(function(t){return t.map(function(t){return t.toFixed(o)}).join("\t")}).join("\n")+e},t}();r.Matrix=e}])});